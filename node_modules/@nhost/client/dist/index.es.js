var po=Object.create;var Mt=Object.defineProperty;var vo=Object.getOwnPropertyDescriptor;var mo=Object.getOwnPropertyNames;var yo=Object.getPrototypeOf,go=Object.prototype.hasOwnProperty;var Eo=e=>Mt(e,"__esModule",{value:!0});var b=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var So=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of mo(t))!go.call(e,i)&&(r||i!=="default")&&Mt(e,i,{get:()=>t[i],enumerable:!(n=vo(t,i))||n.enumerable});return e},wo=(e,t)=>So(Eo(Mt(e!=null?po(yo(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var pr=b((Ac,Kn)=>{"use strict";Kn.exports=function(t,r){return function(){for(var i=new Array(arguments.length),o=0;o<i.length;o++)i[o]=arguments[o];return t.apply(r,i)}}});var j=b((Rc,Zn)=>{"use strict";var qa=pr(),ne=Object.prototype.toString;function yr(e){return Array.isArray(e)}function vr(e){return typeof e>"u"}function Ua(e){return e!==null&&!vr(e)&&e.constructor!==null&&!vr(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Yn(e){return ne.call(e)==="[object ArrayBuffer]"}function Ba(e){return ne.call(e)==="[object FormData]"}function Fa(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Yn(e.buffer),t}function Va(e){return typeof e=="string"}function Ha(e){return typeof e=="number"}function Xn(e){return e!==null&&typeof e=="object"}function xt(e){if(ne.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function Wa(e){return ne.call(e)==="[object Date]"}function Ga(e){return ne.call(e)==="[object File]"}function za(e){return ne.call(e)==="[object Blob]"}function Qn(e){return ne.call(e)==="[object Function]"}function Ja(e){return Xn(e)&&Qn(e.pipe)}function $a(e){return ne.call(e)==="[object URLSearchParams]"}function Ka(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Ya(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function gr(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),yr(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function mr(){var e={};function t(i,o){xt(e[o])&&xt(i)?e[o]=mr(e[o],i):xt(i)?e[o]=mr({},i):yr(i)?e[o]=i.slice():e[o]=i}for(var r=0,n=arguments.length;r<n;r++)gr(arguments[r],t);return e}function Xa(e,t,r){return gr(t,function(i,o){r&&typeof i=="function"?e[o]=qa(i,r):e[o]=i}),e}function Qa(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}Zn.exports={isArray:yr,isArrayBuffer:Yn,isBuffer:Ua,isFormData:Ba,isArrayBufferView:Fa,isString:Va,isNumber:Ha,isObject:Xn,isPlainObject:xt,isUndefined:vr,isDate:Wa,isFile:Ga,isBlob:za,isFunction:Qn,isStream:Ja,isURLSearchParams:$a,isStandardBrowserEnv:Ya,forEach:gr,merge:mr,extend:Xa,trim:Ka,stripBOM:Qa}});var Er=b((Nc,ti)=>{"use strict";var Re=j();function ei(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}ti.exports=function(t,r,n){if(!r)return t;var i;if(n)i=n(r);else if(Re.isURLSearchParams(r))i=r.toString();else{var o=[];Re.forEach(r,function(u,c){u===null||typeof u>"u"||(Re.isArray(u)?c=c+"[]":u=[u],Re.forEach(u,function(d){Re.isDate(d)?d=d.toISOString():Re.isObject(d)&&(d=JSON.stringify(d)),o.push(ei(c)+"="+ei(d))}))}),i=o.join("&")}if(i){var a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}});var ni=b((Ic,ri)=>{"use strict";var Za=j();function bt(){this.handlers=[]}bt.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};bt.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};bt.prototype.forEach=function(t){Za.forEach(this.handlers,function(n){n!==null&&t(n)})};ri.exports=bt});var oi=b((Cc,ii)=>{"use strict";var es=j();ii.exports=function(t,r){es.forEach(t,function(i,o){o!==r&&o.toUpperCase()===r.toUpperCase()&&(t[r]=i,delete t[o])})}});var Sr=b((Dc,ai)=>{"use strict";ai.exports=function(t,r,n,i,o){return t.config=r,n&&(t.code=n),t.request=i,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t}});var wr=b((kc,si)=>{"use strict";var ts=Sr();si.exports=function(t,r,n,i,o){var a=new Error(t);return ts(a,r,n,i,o)}});var ci=b((Mc,ui)=>{"use strict";var rs=wr();ui.exports=function(t,r,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):r(rs("Request failed with status code "+n.status,n.config,null,n.request,n))}});var li=b((jc,fi)=>{"use strict";var Ot=j();fi.exports=Ot.isStandardBrowserEnv()?function(){return{write:function(r,n,i,o,a,s){var u=[];u.push(r+"="+encodeURIComponent(n)),Ot.isNumber(i)&&u.push("expires="+new Date(i).toGMTString()),Ot.isString(o)&&u.push("path="+o),Ot.isString(a)&&u.push("domain="+a),s===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var hi=b((Lc,di)=>{"use strict";di.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}});var vi=b((qc,pi)=>{"use strict";pi.exports=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t}});var yi=b((Uc,mi)=>{"use strict";var ns=hi(),is=vi();mi.exports=function(t,r){return t&&!ns(r)?is(t,r):r}});var Ei=b((Bc,gi)=>{"use strict";var xr=j(),os=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];gi.exports=function(t){var r={},n,i,o;return t&&xr.forEach(t.split(`
`),function(s){if(o=s.indexOf(":"),n=xr.trim(s.substr(0,o)).toLowerCase(),i=xr.trim(s.substr(o+1)),n){if(r[n]&&os.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([i]):r[n]=r[n]?r[n]+", "+i:i}}),r}});var xi=b((Fc,wi)=>{"use strict";var Si=j();wi.exports=Si.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function i(o){var a=o;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=i(window.location.href),function(a){var s=Si.isString(a)?i(a):a;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}()});var Xe=b((Vc,bi)=>{"use strict";function br(e){this.message=e}br.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};br.prototype.__CANCEL__=!0;bi.exports=br});var Tr=b((Hc,Oi)=>{"use strict";var Tt=j(),as=ci(),ss=li(),us=Er(),cs=yi(),fs=Ei(),ls=xi(),Or=wr(),ds=Qe(),hs=Xe();Oi.exports=function(t){return new Promise(function(n,i){var o=t.data,a=t.headers,s=t.responseType,u;function c(){t.cancelToken&&t.cancelToken.unsubscribe(u),t.signal&&t.signal.removeEventListener("abort",u)}Tt.isFormData(o)&&delete a["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",l=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";a.Authorization="Basic "+btoa(d+":"+l)}var h=cs(t.baseURL,t.url);f.open(t.method.toUpperCase(),us(h,t.params,t.paramsSerializer),!0),f.timeout=t.timeout;function g(){if(!!f){var m="getAllResponseHeaders"in f?fs(f.getAllResponseHeaders()):null,T=!s||s==="text"||s==="json"?f.responseText:f.response,v={data:T,status:f.status,statusText:f.statusText,headers:m,config:t,request:f};as(function(C){n(C),c()},function(C){i(C),c()},v),f=null}}if("onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(g)},f.onabort=function(){!f||(i(Or("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){i(Or("Network Error",t,null,f)),f=null},f.ontimeout=function(){var T=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",v=t.transitional||ds.transitional;t.timeoutErrorMessage&&(T=t.timeoutErrorMessage),i(Or(T,t,v.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},Tt.isStandardBrowserEnv()){var y=(t.withCredentials||ls(h))&&t.xsrfCookieName?ss.read(t.xsrfCookieName):void 0;y&&(a[t.xsrfHeaderName]=y)}"setRequestHeader"in f&&Tt.forEach(a,function(T,v){typeof o>"u"&&v.toLowerCase()==="content-type"?delete a[v]:f.setRequestHeader(v,T)}),Tt.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),s&&s!=="json"&&(f.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&f.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(u=function(m){!f||(i(!m||m&&m.type?new hs("canceled"):m),f.abort(),f=null)},t.cancelToken&&t.cancelToken.subscribe(u),t.signal&&(t.signal.aborted?u():t.signal.addEventListener("abort",u))),o||(o=null),f.send(o)})}});var Qe=b((Wc,_i)=>{"use strict";var M=j(),Ti=oi(),ps=Sr(),vs={"Content-Type":"application/x-www-form-urlencoded"};function Pi(e,t){!M.isUndefined(e)&&M.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function ms(){var e;return typeof XMLHttpRequest<"u"?e=Tr():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(e=Tr()),e}function ys(e,t,r){if(M.isString(e))try{return(t||JSON.parse)(e),M.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var Pt={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:ms(),transformRequest:[function(t,r){return Ti(r,"Accept"),Ti(r,"Content-Type"),M.isFormData(t)||M.isArrayBuffer(t)||M.isBuffer(t)||M.isStream(t)||M.isFile(t)||M.isBlob(t)?t:M.isArrayBufferView(t)?t.buffer:M.isURLSearchParams(t)?(Pi(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):M.isObject(t)||r&&r["Content-Type"]==="application/json"?(Pi(r,"application/json"),ys(t)):t}],transformResponse:[function(t){var r=this.transitional||Pt.transitional,n=r&&r.silentJSONParsing,i=r&&r.forcedJSONParsing,o=!n&&this.responseType==="json";if(o||i&&M.isString(t)&&t.length)try{return JSON.parse(t)}catch(a){if(o)throw a.name==="SyntaxError"?ps(a,this,"E_JSON_PARSE"):a}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};M.forEach(["delete","get","head"],function(t){Pt.headers[t]={}});M.forEach(["post","put","patch"],function(t){Pt.headers[t]=M.merge(vs)});_i.exports=Pt});var Ri=b((Gc,Ai)=>{"use strict";var gs=j(),Es=Qe();Ai.exports=function(t,r,n){var i=this||Es;return gs.forEach(n,function(a){t=a.call(i,t,r)}),t}});var Pr=b((zc,Ni)=>{"use strict";Ni.exports=function(t){return!!(t&&t.__CANCEL__)}});var Di=b((Jc,Ci)=>{"use strict";var Ii=j(),_r=Ri(),Ss=Pr(),ws=Qe(),xs=Xe();function Ar(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xs("canceled")}Ci.exports=function(t){Ar(t),t.headers=t.headers||{},t.data=_r.call(t,t.data,t.headers,t.transformRequest),t.headers=Ii.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Ii.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var r=t.adapter||ws.adapter;return r(t).then(function(i){return Ar(t),i.data=_r.call(t,i.data,i.headers,t.transformResponse),i},function(i){return Ss(i)||(Ar(t),i&&i.response&&(i.response.data=_r.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})}});var Rr=b(($c,ki)=>{"use strict";var W=j();ki.exports=function(t,r){r=r||{};var n={};function i(f,d){return W.isPlainObject(f)&&W.isPlainObject(d)?W.merge(f,d):W.isPlainObject(d)?W.merge({},d):W.isArray(d)?d.slice():d}function o(f){if(W.isUndefined(r[f])){if(!W.isUndefined(t[f]))return i(void 0,t[f])}else return i(t[f],r[f])}function a(f){if(!W.isUndefined(r[f]))return i(void 0,r[f])}function s(f){if(W.isUndefined(r[f])){if(!W.isUndefined(t[f]))return i(void 0,t[f])}else return i(void 0,r[f])}function u(f){if(f in r)return i(t[f],r[f]);if(f in t)return i(void 0,t[f])}var c={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return W.forEach(Object.keys(t).concat(Object.keys(r)),function(d){var l=c[d]||o,h=l(d);W.isUndefined(h)&&l!==u||(n[d]=h)}),n}});var Nr=b((Kc,Mi)=>{Mi.exports={version:"0.25.0"}});var qi=b((Yc,Li)=>{"use strict";var bs=Nr().version,Ir={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){Ir[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var ji={};Ir.transitional=function(t,r,n){function i(o,a){return"[Axios v"+bs+"] Transitional option '"+o+"'"+a+(n?". "+n:"")}return function(o,a,s){if(t===!1)throw new Error(i(a," has been removed"+(r?" in "+r:"")));return r&&!ji[a]&&(ji[a]=!0,console.warn(i(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(o,a,s):!0}};function Os(e,t,r){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var o=n[i],a=t[o];if(a){var s=e[o],u=s===void 0||a(s,o,e);if(u!==!0)throw new TypeError("option "+o+" must be "+u);continue}if(r!==!0)throw Error("Unknown option "+o)}}Li.exports={assertOptions:Os,validators:Ir}});var Wi=b((Xc,Hi)=>{"use strict";var Fi=j(),Ts=Er(),Ui=ni(),Bi=Di(),_t=Rr(),Vi=qi(),Ne=Vi.validators;function Ze(e){this.defaults=e,this.interceptors={request:new Ui,response:new Ui}}Ze.prototype.request=function(t,r){if(typeof t=="string"?(r=r||{},r.url=t):r=t||{},!r.url)throw new Error("Provided config url is not valid");r=_t(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&Vi.assertOptions(n,{silentJSONParsing:Ne.transitional(Ne.boolean),forcedJSONParsing:Ne.transitional(Ne.boolean),clarifyTimeoutError:Ne.transitional(Ne.boolean)},!1);var i=[],o=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(o=o&&h.synchronous,i.unshift(h.fulfilled,h.rejected))});var a=[];this.interceptors.response.forEach(function(h){a.push(h.fulfilled,h.rejected)});var s;if(!o){var u=[Bi,void 0];for(Array.prototype.unshift.apply(u,i),u=u.concat(a),s=Promise.resolve(r);u.length;)s=s.then(u.shift(),u.shift());return s}for(var c=r;i.length;){var f=i.shift(),d=i.shift();try{c=f(c)}catch(l){d(l);break}}try{s=Bi(c)}catch(l){return Promise.reject(l)}for(;a.length;)s=s.then(a.shift(),a.shift());return s};Ze.prototype.getUri=function(t){if(!t.url)throw new Error("Provided config url is not valid");return t=_t(this.defaults,t),Ts(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};Fi.forEach(["delete","get","head","options"],function(t){Ze.prototype[t]=function(r,n){return this.request(_t(n||{},{method:t,url:r,data:(n||{}).data}))}});Fi.forEach(["post","put","patch"],function(t){Ze.prototype[t]=function(r,n,i){return this.request(_t(i||{},{method:t,url:r,data:n}))}});Hi.exports=Ze});var zi=b((Qc,Gi)=>{"use strict";var Ps=Xe();function Ie(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(i){t=i});var r=this;this.promise.then(function(n){if(!!r._listeners){var i,o=r._listeners.length;for(i=0;i<o;i++)r._listeners[i](n);r._listeners=null}}),this.promise.then=function(n){var i,o=new Promise(function(a){r.subscribe(a),i=a}).then(n);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i){r.reason||(r.reason=new Ps(i),t(r.reason))})}Ie.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Ie.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]};Ie.prototype.unsubscribe=function(t){if(!!this._listeners){var r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}};Ie.source=function(){var t,r=new Ie(function(i){t=i});return{token:r,cancel:t}};Gi.exports=Ie});var $i=b((Zc,Ji)=>{"use strict";Ji.exports=function(t){return function(n){return t.apply(null,n)}}});var Yi=b((ef,Ki)=>{"use strict";var _s=j();Ki.exports=function(t){return _s.isObject(t)&&t.isAxiosError===!0}});var Zi=b((tf,Cr)=>{"use strict";var Xi=j(),As=pr(),At=Wi(),Rs=Rr(),Ns=Qe();function Qi(e){var t=new At(e),r=As(At.prototype.request,t);return Xi.extend(r,At.prototype,t),Xi.extend(r,t),r.create=function(i){return Qi(Rs(e,i))},r}var X=Qi(Ns);X.Axios=At;X.Cancel=Xe();X.CancelToken=zi();X.isCancel=Pr();X.VERSION=Nr().version;X.all=function(t){return Promise.all(t)};X.spread=$i();X.isAxiosError=Yi();Cr.exports=X;Cr.exports.default=X});var to=b((rf,eo)=>{eo.exports=Zi()});function jr(e){return!!(e&&typeof e.then=="function")}var xo=Promise.resolve(!1),Ms=Promise.resolve(!0),K=Promise.resolve();function et(e,t){return e||(e=0),new Promise(function(r){return setTimeout(function(){return r(t)},e)})}function Lr(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Ce(){return Math.random().toString(36).substring(2)}var Mr=0,jt=0;function te(){var e=new Date().getTime();return e===Mr?(jt++,e*1e3+jt):(Mr=e,jt=0,e*1e3)}var re=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";var bo=te,Oo="native";function To(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function Po(e){e.bc.close(),e.subFns=[]}function _o(e,t){try{return e.bc.postMessage(t,!1),K}catch(r){return Promise.reject(r)}}function Ao(e,t){e.messagesCallback=t}function Ro(){if(re&&typeof window>"u")return!1;if(typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function No(){return 150}var qr={create:To,close:Po,onMessage:Ao,postMessage:_o,canBeUsed:Ro,type:Oo,averageResponseTime:No,microSeconds:bo};var tt=function(){function e(t){this.ttl=t,this.set=new Set,this.timeMap=new Map}return e.prototype.has=function(t){return this.set.has(t)},e.prototype.add=function(t){var r=this;this.timeMap.set(t,Ur()),this.set.add(t),setTimeout(function(){Io(r)},0)},e.prototype.clear=function(){this.set.clear(),this.timeMap.clear()},e}();function Io(e){for(var t=Ur()-e.ttl,r=e.set[Symbol.iterator]();;){var n=r.next().value;if(!n)return;var i=e.timeMap.get(n);if(i<t)e.timeMap.delete(n),e.set.delete(n);else return}}function Ur(){return new Date().getTime()}function ye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var Co=te,Do="pubkey.broadcast-channel-0-",Q="messages",ko="idb";function Br(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function Mo(e){var t=Br(),r=Do+e,n=t.open(r,1);n.onupgradeneeded=function(o){var a=o.target.result;a.createObjectStore(Q,{keyPath:"id",autoIncrement:!0})};var i=new Promise(function(o,a){n.onerror=function(s){return a(s)},n.onsuccess=function(){o(n.result)}});return i}function jo(e,t,r){var n=new Date().getTime(),i={uuid:t,time:n,data:r},o=e.transaction([Q],"readwrite");return new Promise(function(a,s){o.oncomplete=function(){return a()},o.onerror=function(c){return s(c)};var u=o.objectStore(Q);u.add(i)})}function Lo(e,t){var r=e.transaction(Q).objectStore(Q),n=[];function i(){try{var o=IDBKeyRange.bound(t+1,1/0);return r.openCursor(o)}catch{return r.openCursor()}}return new Promise(function(o){i().onsuccess=function(a){var s=a.target.result;s?s.value.id<t+1?s.continue(t+1):(n.push(s.value),s.continue()):o(n)}})}function qo(e,t){var r=e.transaction([Q],"readwrite").objectStore(Q).delete(t);return new Promise(function(n){r.onsuccess=function(){return n()}})}function Uo(e,t){var r=new Date().getTime()-t,n=e.transaction(Q).objectStore(Q),i=[];return new Promise(function(o){n.openCursor().onsuccess=function(a){var s=a.target.result;if(s){var u=s.value;if(u.time<r)i.push(u),s.continue();else{o(i);return}}else o(i)}})}function Bo(e,t){return Uo(e,t).then(function(r){return Promise.all(r.map(function(n){return qo(e,n.id)}))})}function Fo(e,t){return t=ye(t),Mo(e).then(function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:Ce(),eMIs:new tt(t.idb.ttl*2),writeBlockPromise:K,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},Fr(n),n})}function Fr(e){e.closed||Vr(e).then(function(){return et(e.options.idb.fallbackInterval)}).then(function(){return Fr(e)})}function Vo(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function Vr(e){return e.closed?K:e.messagesCallback?Lo(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return Vo(n,e)}).sort(function(n,i){return n.time-i.time});return r.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),K}):K}function Ho(e){e.closed=!0,e.db.close()}function Wo(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return jo(e.db,e.uuid,t)}).then(function(){Lr(0,10)===0&&Bo(e.db,e.options.idb.ttl)}),e.writeBlockPromise}function Go(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,Vr(e)}function zo(){if(re)return!1;var e=Br();return!!e}function Jo(e){return e.idb.fallbackInterval*2}var Hr={create:Fo,close:Ho,onMessage:Go,postMessage:Wo,canBeUsed:zo,type:ko,averageResponseTime:Jo,microSeconds:Co};var $o=te,Ko="pubkey.broadcastChannel-",Yo="localstorage";function Wr(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Gr(e){return Ko+e}function Xo(e,t){return new Promise(function(r){et().then(function(){var n=Gr(e.channelName),i={token:Ce(),time:new Date().getTime(),data:t,uuid:e.uuid},o=JSON.stringify(i);Wr().setItem(n,o);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=n,a.newValue=o,window.dispatchEvent(a),r()})})}function Qo(e,t){var r=Gr(e),n=function(o){o.key===r&&t(JSON.parse(o.newValue))};return window.addEventListener("storage",n),n}function Zo(e){window.removeEventListener("storage",e)}function ea(e,t){if(t=ye(t),!zr())throw new Error("BroadcastChannel: localstorage cannot be used");var r=Ce(),n=new tt(t.localstorage.removeTimeout),i={channelName:e,uuid:r,eMIs:n};return i.listener=Qo(e,function(o){!i.messagesCallback||o.uuid!==r&&(!o.token||n.has(o.token)||o.data.time&&o.data.time<i.messagesCallbackTime||(n.add(o.token),i.messagesCallback(o.data)))}),i}function ta(e){Zo(e.listener)}function ra(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function zr(){if(re)return!1;var e=Wr();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function na(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var Jr={create:ea,close:ta,onMessage:ra,postMessage:Xo,canBeUsed:zr,type:Yo,averageResponseTime:na,microSeconds:$o};var ia=te,oa="simulate",Lt=new Set;function aa(e){var t={name:e,messagesCallback:null};return Lt.add(t),t}function sa(e){Lt.delete(e)}function ua(e,t){return new Promise(function(r){return setTimeout(function(){var n=Array.from(Lt);n.filter(function(i){return i.name===e.name}).filter(function(i){return i!==e}).filter(function(i){return!!i.messagesCallback}).forEach(function(i){return i.messagesCallback(t)}),r()},5)})}function ca(e,t){e.messagesCallback=t}function fa(){return!0}function la(){return 5}var $r={create:aa,close:sa,onMessage:ca,postMessage:ua,canBeUsed:fa,type:oa,averageResponseTime:la,microSeconds:ia};var Kr=[qr,Hr,Jr];function Yr(e){var t=[].concat(e.methods,Kr).filter(Boolean);if(e.type){if(e.type==="simulate")return $r;var r=t.find(function(i){return i.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}!e.webWorkerSupport&&!re&&(t=t.filter(function(i){return i.type!=="idb"}));var n=t.find(function(i){return i.canBeUsed()});if(n)return n;throw new Error("No useable method found in "+JSON.stringify(Kr.map(function(i){return i.type})))}var qt=new Set,da=0,ae=function(t,r){this.id=da++,qt.add(this),this.name=t,Xr&&(r=Xr),this.options=ye(r),this.method=Yr(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,ha(this)};ae._pubkey=!0;var Xr;ae.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return Qr(this,"message",t)},postInternal:function(t){return Qr(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};en(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,Zr(this,"message",r)):this._onML=null},addEventListener:function(t,r){var n=this.method.microSeconds(),i={time:n,fn:r};Zr(this,t,i)},removeEventListener:function(t,r){var n=this._addEL[t].find(function(i){return i.fn===r});en(this,t,n)},close:function(){var t=this;if(!this.closed){qt.delete(this),this.closed=!0;var r=this._prepP?this._prepP:K;return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(n){return n()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function Qr(e,t,r){var n=e.method.microSeconds(),i={time:n,type:t,data:r},o=e._prepP?e._prepP:K;return o.then(function(){var a=e.method.postMessage(e._state,i);return e._uMP.add(a),a.catch().then(function(){return e._uMP.delete(a)}),a})}function ha(e){var t=e.method.create(e.name,e.options);jr(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function tn(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Zr(e,t,r){e._addEL[t].push(r),pa(e)}function en(e,t,r){e._addEL[t]=e._addEL[t].filter(function(n){return n!==r}),va(e)}function pa(e){if(!e._iL&&tn(e)){var t=function(i){e._addEL[i.type].forEach(function(o){var a=1e5,s=o.time-a;i.time>=s&&o.fn(i.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function va(e){if(e._iL&&!tn(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}function $(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!1)var i,o;throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(a){return"'"+a+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ge(e){return!!e&&!!e[F]}function ue(e){return!!e&&(function(t){if(!t||typeof t!="object")return!1;var r=Object.getPrototypeOf(t);if(r===null)return!0;var n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return n===Object||typeof n=="function"&&Function.toString.call(n)===ba}(e)||Array.isArray(e)||!!e[fn]||!!e.constructor[fn]||$t(e)||Kt(e))}function ke(e,t,r){r===void 0&&(r=!1),Ee(e)===0?(r?Object.keys:er)(e).forEach(function(n){r&&typeof n=="symbol"||t(n,e[n],e)}):e.forEach(function(n,i){return t(i,n,e)})}function Ee(e){var t=e[F];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:$t(e)?2:Kt(e)?3:0}function Ht(e,t){return Ee(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ma(e,t){return Ee(e)===2?e.get(t):e[t]}function ln(e,t,r){var n=Ee(e);n===2?e.set(t,r):n===3?(e.delete(t),e.add(r)):e[t]=r}function ya(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function $t(e){return wa&&e instanceof Map}function Kt(e){return xa&&e instanceof Set}function se(e){return e.o||e.t}function Yt(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Oa(e);delete t[F];for(var r=er(t),n=0;n<r.length;n++){var i=r[n],o=t[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Xt(e,t){return t===void 0&&(t=!1),Qt(e)||ge(e)||!ue(e)||(Ee(e)>1&&(e.set=e.add=e.clear=e.delete=ga),Object.freeze(e),t&&ke(e,function(r,n){return Xt(n,!0)},!0)),e}function ga(){$(2)}function Qt(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function Y(e){var t=Ta[e];return t||$(18,e),t}function rn(){return Me}function Ut(e,t){t&&(Y("Patches"),e.u=[],e.s=[],e.v=t)}function rt(e){Wt(e),e.p.forEach(Ea),e.p=null}function Wt(e){e===Me&&(Me=e.l)}function nn(e){return Me={p:[],l:Me,h:e,m:!0,_:0}}function Ea(e){var t=e[F];t.i===0||t.i===1?t.j():t.O=!0}function Bt(e,t){t._=t.p.length;var r=t.p[0],n=e!==void 0&&e!==r;return t.h.g||Y("ES5").S(t,e,n),n?(r[F].P&&(rt(t),$(4)),ue(e)&&(e=nt(t,e),t.l||it(t,e)),t.u&&Y("Patches").M(r[F].t,e,t.u,t.s)):e=nt(t,r,[]),rt(t),t.u&&t.v(t.u,t.s),e!==dn?e:void 0}function nt(e,t,r){if(Qt(t))return t;var n=t[F];if(!n)return ke(t,function(o,a){return on(e,n,t,o,a,r)},!0),t;if(n.A!==e)return t;if(!n.P)return it(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=n.i===4||n.i===5?n.o=Yt(n.k):n.o;ke(n.i===3?new Set(i):i,function(o,a){return on(e,n,i,o,a,r)}),it(e,i,!1),r&&e.u&&Y("Patches").R(n,r,e.u,e.s)}return n.o}function on(e,t,r,n,i,o){if(ge(i)){var a=nt(e,i,o&&t&&t.i!==3&&!Ht(t.D,n)?o.concat(n):void 0);if(ln(r,n,a),!ge(a))return;e.m=!1}if(ue(i)&&!Qt(i)){if(!e.h.F&&e._<1)return;nt(e,i),t&&t.A.l||it(e,i)}}function it(e,t,r){r===void 0&&(r=!1),e.h.F&&e.m&&Xt(t,r)}function Ft(e,t){var r=e[F];return(r?se(r):e)[t]}function an(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function Gt(e){e.P||(e.P=!0,e.l&&Gt(e.l))}function Vt(e){e.o||(e.o=Yt(e.t))}function zt(e,t,r){var n=$t(t)?Y("MapSet").N(t,r):Kt(t)?Y("MapSet").T(t,r):e.g?function(i,o){var a=Array.isArray(i),s={i:a?1:0,A:o?o.A:rn(),P:!1,I:!1,D:{},l:o,t:i,k:null,o:null,j:null,C:!1},u=s,c=Jt;a&&(u=[s],c=De);var f=Proxy.revocable(u,c),d=f.revoke,l=f.proxy;return s.k=l,s.j=d,l}(t,r):Y("ES5").J(t,r);return(r?r.A:rn()).p.push(n),n}function Sa(e){return ge(e)||$(22,e),function t(r){if(!ue(r))return r;var n,i=r[F],o=Ee(r);if(i){if(!i.P&&(i.i<4||!Y("ES5").K(i)))return i.t;i.I=!0,n=sn(r,o),i.I=!1}else n=sn(r,o);return ke(n,function(a,s){i&&ma(i.t,a)===s||ln(n,a,t(s))}),o===3?new Set(n):n}(e)}function sn(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Yt(e)}var un,Me,Zt=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",wa=typeof Map<"u",xa=typeof Set<"u",cn=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",dn=Zt?Symbol.for("immer-nothing"):((un={})["immer-nothing"]=!0,un),fn=Zt?Symbol.for("immer-draftable"):"__$immer_draftable",F=Zt?Symbol.for("immer-state"):"__$immer_state",lu=typeof Symbol<"u"&&Symbol.iterator||"@@iterator";var ba=""+Object.prototype.constructor,er=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Oa=Object.getOwnPropertyDescriptors||function(e){var t={};return er(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},Ta={},Jt={get:function(e,t){if(t===F)return e;var r=se(e);if(!Ht(r,t))return function(i,o,a){var s,u=an(o,a);return u?"value"in u?u.value:(s=u.get)===null||s===void 0?void 0:s.call(i.k):void 0}(e,r,t);var n=r[t];return e.I||!ue(n)?n:n===Ft(e.t,t)?(Vt(e),e.o[t]=zt(e.A.h,n,e)):n},has:function(e,t){return t in se(e)},ownKeys:function(e){return Reflect.ownKeys(se(e))},set:function(e,t,r){var n=an(se(e),t);if(n==null?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=Ft(se(e),t),o=i==null?void 0:i[F];if(o&&o.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(ya(r,i)&&(r!==void 0||Ht(e.t,t)))return!0;Vt(e),Gt(e)}return e.o[t]===r&&typeof r!="number"&&(r!==void 0||t in e.o)||(e.o[t]=r,e.D[t]=!0,!0)},deleteProperty:function(e,t){return Ft(e.t,t)!==void 0||t in e.t?(e.D[t]=!1,Vt(e),Gt(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=se(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty:function(){$(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){$(12)}},De={};ke(Jt,function(e,t){De[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),De.deleteProperty=function(e,t){return De.set.call(this,e,t,void 0)},De.set=function(e,t,r){return Jt.set.call(this,e[0],t,r,e[0])};var Pa=function(){function e(r){var n=this;this.g=cn,this.F=!0,this.produce=function(i,o,a){if(typeof i=="function"&&typeof o!="function"){var s=o;o=i;var u=n;return function(y){var m=this;y===void 0&&(y=s);for(var T=arguments.length,v=Array(T>1?T-1:0),E=1;E<T;E++)v[E-1]=arguments[E];return u.produce(y,function(C){var R;return(R=o).call.apply(R,[m,C].concat(v))})}}var c;if(typeof o!="function"&&$(6),a!==void 0&&typeof a!="function"&&$(7),ue(i)){var f=nn(n),d=zt(n,i,void 0),l=!0;try{c=o(d),l=!1}finally{l?rt(f):Wt(f)}return typeof Promise<"u"&&c instanceof Promise?c.then(function(y){return Ut(f,a),Bt(y,f)},function(y){throw rt(f),y}):(Ut(f,a),Bt(c,f))}if(!i||typeof i!="object"){if((c=o(i))===void 0&&(c=i),c===dn&&(c=void 0),n.F&&Xt(c,!0),a){var h=[],g=[];Y("Patches").M(i,c,h,g),a(h,g)}return c}$(21,i)},this.produceWithPatches=function(i,o){if(typeof i=="function")return function(c){for(var f=arguments.length,d=Array(f>1?f-1:0),l=1;l<f;l++)d[l-1]=arguments[l];return n.produceWithPatches(c,function(h){return i.apply(void 0,[h].concat(d))})};var a,s,u=n.produce(i,o,function(c,f){a=c,s=f});return typeof Promise<"u"&&u instanceof Promise?u.then(function(c){return[c,a,s]}):[u,a,s]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var t=e.prototype;return t.createDraft=function(r){ue(r)||$(8),ge(r)&&(r=Sa(r));var n=nn(this),i=zt(this,r,void 0);return i[F].C=!0,Wt(n),i},t.finishDraft=function(r,n){var i=r&&r[F],o=i.A;return Ut(o,n),Bt(void 0,o)},t.setAutoFreeze=function(r){this.F=r},t.setUseProxies=function(r){r&&!cn&&$(20),this.g=r},t.applyPatches=function(r,n){var i;for(i=n.length-1;i>=0;i--){var o=n[i];if(o.path.length===0&&o.op==="replace"){r=o.value;break}}i>-1&&(n=n.slice(i+1));var a=Y("Patches").$;return ge(r)?a(r,n):this.produce(r,function(s){return a(s,n)})},e}(),V=new Pa,_a=V.produce,du=V.produceWithPatches.bind(V),hu=V.setAutoFreeze.bind(V),pu=V.setUseProxies.bind(V),vu=V.applyPatches.bind(V),mu=V.createDraft.bind(V),yu=V.finishDraft.bind(V),hn=_a;var p=function(){return p=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},p.apply(this,arguments)};function Se(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function N(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o}function _(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var O;(function(e){e.Start="xstate.start",e.Stop="xstate.stop",e.Raise="xstate.raise",e.Send="xstate.send",e.Cancel="xstate.cancel",e.NullEvent="",e.Assign="xstate.assign",e.After="xstate.after",e.DoneState="done.state",e.DoneInvoke="done.invoke",e.Log="xstate.log",e.Init="xstate.init",e.Invoke="xstate.invoke",e.ErrorExecution="error.execution",e.ErrorCommunication="error.communication",e.ErrorPlatform="error.platform",e.ErrorCustom="xstate.error",e.Update="xstate.update",e.Pure="xstate.pure",e.Choose="xstate.choose"})(O||(O={}));var we;(function(e){e.Parent="#_parent",e.Internal="#_internal"})(we||(we={}));var tr=O.Start,ot=O.Stop,xe=O.Raise,je=O.Send,pn=O.Cancel,vn=O.NullEvent,at=O.Assign,xu=O.After,bu=O.DoneState,mn=O.Log,yn=O.Init,Le=O.Invoke,Ou=O.ErrorExecution,Tu=O.ErrorPlatform,Aa=O.ErrorCustom,rr=O.Update,gn=O.Choose,En=O.Pure;var st=".",nr={},ut="xstate.guard",Sn="";var q=!0;var ct;function Ue(e,t,r){r===void 0&&(r=st);var n=be(e,r),i=be(t,r);return S(i)?S(n)?i===n:!1:S(n)?n in i:Object.keys(n).every(function(o){return o in i?Ue(n[o],i[o]):!1})}function ft(e){try{return S(e)||typeof e=="number"?"".concat(e):e.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function lt(e,t){try{return ce(e)?e:e.toString().split(t)}catch{throw new Error("'".concat(e,"' is not a valid state path."))}}function Ra(e){return typeof e=="object"&&"value"in e&&"context"in e&&"event"in e&&"_event"in e}function be(e,t){if(Ra(e))return e.value;if(ce(e))return qe(e);if(typeof e!="string")return e;var r=lt(e,t);return qe(r)}function qe(e){if(e.length===1)return e[0];for(var t={},r=t,n=0;n<e.length-1;n++)n===e.length-2?r[e[n]]=e[n+1]:(r[e[n]]={},r=r[e[n]]);return t}function Oe(e,t){for(var r={},n=Object.keys(e),i=0;i<n.length;i++){var o=n[i];r[o]=t(e[o],o,e,i)}return r}function ir(e,t,r){var n,i,o={};try{for(var a=N(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];!r(c)||(o[u]=t(c,u,e))}}catch(f){n={error:f}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o}var wn=function(e){return function(t){var r,n,i=t;try{for(var o=N(e),a=o.next();!a.done;a=o.next()){var s=a.value;i=i[s]}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}};function xn(e,t){return function(r){var n,i,o=r;try{for(var a=N(e),s=a.next();!s.done;s=a.next()){var u=s.value;o=o[t][u]}}catch(c){n={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o}}function Be(e){if(!e)return[[]];if(S(e))return[[e]];var t=P(Object.keys(e).map(function(r){var n=e[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:Be(e[r]).map(function(i){return[r].concat(i)})}));return t}function P(e){var t;return(t=[]).concat.apply(t,_([],w(e),!1))}function bn(e){return ce(e)?e:[e]}function H(e){return e===void 0?[]:bn(e)}function dt(e,t,r){var n,i;if(I(e))return e(t,r.data);var o={};try{for(var a=N(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];I(c)?o[u]=c(t,r.data):o[u]=c}}catch(f){n={error:f}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o}function On(e){return/^(done|error)\./.test(e)}function ht(e,t){var r,n,i=w([[],[]],2),o=i[0],a=i[1];try{for(var s=N(e),u=s.next();!u.done;u=s.next()){var c=u.value;t(c)?o.push(c):a.push(c)}}catch(f){r={error:f}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return[o,a]}function Tn(e,t){return Oe(e.states,function(r,n){if(!!r){var i=(S(t)?void 0:t[n])||(r?r.current:void 0);if(!!i)return{current:i,states:Tn(r,i)}}})}function Pn(e,t){return{current:t,states:Tn(e,t)}}function or(e,t,r,n){q||J(!!e,"Attempting to update undefined context");var i=e&&r.reduce(function(o,a){var s,u,c=a.assignment,f={state:n,action:a,_event:t},d={};if(I(c))d=c(o,t.data,f);else try{for(var l=N(Object.keys(c)),h=l.next();!h.done;h=l.next()){var g=h.value,y=c[g];d[g]=I(y)?y(o,t.data,f):y}}catch(m){s={error:m}}finally{try{h&&!h.done&&(u=l.return)&&u.call(l)}finally{if(s)throw s.error}}return Object.assign({},o,d)},e);return i}var J=function(){};q||(J=function(e,t){var r=e instanceof Error?e:void 0;if(!(!r&&e)&&console!==void 0){var n=["Warning: ".concat(t)];r&&n.push(r),console.warn.apply(console,n)}});function ce(e){return Array.isArray(e)}function I(e){return typeof e=="function"}function S(e){return typeof e=="string"}function pt(e,t){if(!!e)return S(e)?{type:ut,name:e,predicate:t?t[e]:void 0}:I(e)?{type:ut,name:e.name,predicate:e}:e}var ar=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Cu=(ct={},ct[ar]=function(){return this},ct[Symbol.observable]=function(){return this},ct);function fe(e){return!!e&&"__xstatenode"in e}function sr(e,t){return S(e)||typeof e=="number"?p({type:e},t):e}function le(e,t){if(!S(e)&&"$$type"in e&&e.$$type==="scxml")return e;var r=sr(e);return p({name:r.type,data:r,$$type:"scxml",type:"external"},t)}function de(e,t){var r=bn(t).map(function(n){return typeof n>"u"||typeof n=="string"||fe(n)?{target:n,event:e}:p(p({},n),{event:e})});return r}function _n(e){if(!(e===void 0||e===Sn))return H(e)}function vt(e,t,r,n,i){var o=e.options.guards,a={state:i,cond:t,_event:n};if(t.type===ut)return((o==null?void 0:o[t.name])||t.predicate)(r,n.data,a);var s=o==null?void 0:o[t.type];if(!s)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return s(r,n.data,a)}function An(e){return typeof e=="string"?{type:e}:e}function Fe(e,t){return"".concat(e,":invocation[").concat(t,"]")}var He=le({type:yn});function Rn(e,t){return t&&t[e]||void 0}function Te(e,t){var r;if(S(e)||typeof e=="number"){var n=Rn(e,t);I(n)?r={type:e,exec:n}:n?r=n:r={type:e,exec:void 0}}else if(I(e))r={type:e.name||e.toString(),exec:e};else{var n=Rn(e.type,t);if(I(n))r=p(p({},e),{exec:n});else if(n){var i=n.type||e.type;r=p(p(p({},n),e),{type:i})}else r=e}return r}var Ve=function(e,t){if(!e)return[];var r=ce(e)?e:[e];return r.map(function(n){return Te(n,t)})};function yt(e){var t=Te(e);return p(p({id:S(e)?e:t.id},t),{type:t.type})}function Nn(e){return S(e)?{type:xe,event:e}:gt(e,{to:we.Internal})}function Na(e){return{type:xe,_event:le(e.event)}}function gt(e,t){return{to:t?t.to:void 0,type:je,event:I(e)?e:sr(e),delay:t?t.delay:void 0,id:t&&t.id!==void 0?t.id:I(e)?e.name:ft(e)}}function Ia(e,t,r,n){var i={_event:r},o=le(I(e.event)?e.event(t,r.data,i):e.event),a;if(S(e.delay)){var s=n&&n[e.delay];a=I(s)?s(t,r.data,i):s}else a=I(e.delay)?e.delay(t,r.data,i):e.delay;var u=I(e.to)?e.to(t,r.data,i):e.to;return p(p({},e),{to:u,_event:o,event:o.data,delay:a})}var Ca=function(e,t,r){return p(p({},e),{value:S(e.expr)?e.expr:e.expr(t,r.data,{_event:r})})},In=function(e){return{type:pn,sendId:e}};function Cn(e){var t=yt(e);return{type:O.Start,activity:t,exec:void 0}}function Dn(e){var t=I(e)?e:yt(e);return{type:O.Stop,activity:t,exec:void 0}}function Da(e,t,r){var n=I(e.activity)?e.activity(t,r.data):e.activity,i=typeof n=="string"?{id:n}:n,o={type:O.Stop,activity:i};return o}var kn=function(e){return{type:at,assignment:e}};function Mn(e,t){var r=t?"#".concat(t):"";return"".concat(O.After,"(").concat(e,")").concat(r)}function We(e,t){var r="".concat(O.DoneState,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function ur(e,t){var r="".concat(O.DoneInvoke,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function jn(e,t){var r="".concat(O.ErrorPlatform,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function mt(e,t,r,n,i,o){o===void 0&&(o=!1);var a=w(o?[[],i]:ht(i,function(l){return l.type===at}),2),s=a[0],u=a[1],c=s.length?or(r,n,s,t):r,f=o?[r]:void 0,d=P(u.map(function(l){var h;switch(l.type){case xe:return Na(l);case je:var g=Ia(l,c,n,e.options.delays);return q||J(!S(l.delay)||typeof g.delay=="number","No delay reference for delay expression '".concat(l.delay,"' was found on machine '").concat(e.id,"'")),g;case mn:return Ca(l,c,n);case gn:{var y=l,m=(h=y.conds.find(function(D){var z=pt(D.cond,e.options.guards);return!z||vt(e,z,c,n,t)}))===null||h===void 0?void 0:h.actions;if(!m)return[];var T=w(mt(e,t,c,n,Ve(H(m),e.options.actions),o),2),v=T[0],E=T[1];return c=E,f==null||f.push(c),v}case En:{var m=l.get(c,n.data);if(!m)return[];var C=w(mt(e,t,c,n,Ve(H(m),e.options.actions),o),2),R=C[0],G=C[1];return c=G,f==null||f.push(c),R}case ot:return Da(l,c,n);case at:{c=or(c,n,[l],t),f==null||f.push(c);break}default:var x=Te(l,e.options.actions),A=x.exec;if(A&&f){var L=f.length-1;x=p(p({},x),{exec:function(D){for(var z=[],oe=1;oe<arguments.length;oe++)z[oe-1]=arguments[oe];A.apply(void 0,_([f[L]],w(z),!1))}})}return x}}).filter(function(l){return!!l}));return[d,c]}var Ln=[],qn=function(e,t){Ln.push(e);var r=t(e);return Ln.pop(),r};function Un(e){var t;return t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}},t[ar]=function(){return this},t}function Bn(e,t,r,n){var i,o=An(e.src),a=(i=t==null?void 0:t.options.services)===null||i===void 0?void 0:i[o.type],s=e.data?dt(e.data,r,n):void 0,u=a?ka(a,e.id,s):Un(e.id);return u.meta=e,u}function ka(e,t,r){var n=Un(t);if(n.deferred=!0,fe(e)){var i=n.state=qn(void 0,function(){return(r?e.withContext(r):e).initialState});n.getSnapshot=function(){return i}}return n}var Ge=function(e){return e.type==="atomic"||e.type==="final"};function he(e){return Object.keys(e.states).map(function(t){return e.states[t]})}function fr(e){var t=[e];return Ge(e)?t:t.concat(P(he(e).map(fr)))}function pe(e,t){var r,n,i,o,a,s,u,c,f=new Set(e),d=cr(f),l=new Set(t);try{for(var h=N(l),g=h.next();!g.done;g=h.next())for(var y=g.value,m=y.parent;m&&!l.has(m);)l.add(m),m=m.parent}catch(L){r={error:L}}finally{try{g&&!g.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}var T=cr(l);try{for(var v=N(l),E=v.next();!E.done;E=v.next()){var y=E.value;if(y.type==="compound"&&(!T.get(y)||!T.get(y).length))d.get(y)?d.get(y).forEach(function(D){return l.add(D)}):y.initialStateNodes.forEach(function(D){return l.add(D)});else if(y.type==="parallel")try{for(var C=(a=void 0,N(he(y))),R=C.next();!R.done;R=C.next()){var G=R.value;G.type!=="history"&&(l.has(G)||(l.add(G),d.get(G)?d.get(G).forEach(function(D){return l.add(D)}):G.initialStateNodes.forEach(function(D){return l.add(D)})))}}catch(D){a={error:D}}finally{try{R&&!R.done&&(s=C.return)&&s.call(C)}finally{if(a)throw a.error}}}}catch(L){i={error:L}}finally{try{E&&!E.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var x=N(l),A=x.next();!A.done;A=x.next())for(var y=A.value,m=y.parent;m&&!l.has(m);)l.add(m),m=m.parent}catch(L){u={error:L}}finally{try{A&&!A.done&&(c=x.return)&&c.call(x)}finally{if(u)throw u.error}}return l}function Fn(e,t){var r=t.get(e);if(!r)return{};if(e.type==="compound"){var n=r[0];if(n){if(Ge(n))return n.key}else return{}}var i={};return r.forEach(function(o){i[o.key]=Fn(o,t)}),i}function cr(e){var t,r,n=new Map;try{for(var i=N(e),o=i.next();!o.done;o=i.next()){var a=o.value;n.has(a)||n.set(a,[]),a.parent&&(n.has(a.parent)||n.set(a.parent,[]),n.get(a.parent).push(a))}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}function Vn(e,t){var r=pe([e],t);return Fn(e,cr(r))}function ze(e,t){return Array.isArray(e)?e.some(function(r){return r===t}):e instanceof Set?e.has(t):!1}function Hn(e){return _([],w(new Set(P(_([],w(e.map(function(t){return t.ownEvents})),!1)))),!1)}function Je(e,t){return t.type==="compound"?he(t).some(function(r){return r.type==="final"&&ze(e,r)}):t.type==="parallel"?he(t).every(function(r){return Je(e,r)}):!1}function Wn(e){return e===void 0&&(e=[]),e.reduce(function(t,r){return r.meta!==void 0&&(t[r.id]=r.meta),t},{})}function lr(e){return new Set(P(e.map(function(t){return t.tags})))}function dr(e,t){if(e===t)return!0;if(e===void 0||t===void 0)return!1;if(S(e)||S(t))return e===t;var r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every(function(i){return dr(e[i],t[i])})}var Z=function(){function e(t){var r=this,n;this.actions=[],this.activities=nr,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||nr,this.meta=Wn(t.configuration),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=(n=Array.isArray(t.tags)?new Set(t.tags):t.tags)!==null&&n!==void 0?n:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Hn(r.configuration)}})}return e.from=function(t,r){if(t instanceof e)return t.context!==r?new e({value:t.value,context:r,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t;var n=He;return new e({value:t,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,r){if(t instanceof e){if(!t.actions.length)return t;var n=He;return new e({value:t.value,context:r,_event:n,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,r)},e.prototype.toStrings=function(t,r){var n=this;if(t===void 0&&(t=this.value),r===void 0&&(r="."),S(t))return[t];var i=Object.keys(t);return i.concat.apply(i,_([],w(i.map(function(o){return n.toStrings(t[o],r).map(function(a){return o+r+a})})),!1))},e.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var r=t.tags;t.machine;var n=Se(t,["configuration","transitions","tags","machine"]);return p(p({},n),{tags:Array.from(r)})},e.prototype.matches=function(t){return Ue(t,this.value)},e.prototype.hasTag=function(t){return this.tags.has(t)},e.prototype.can=function(t){var r;q&&J(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,t);return!!(n==null?void 0:n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},e}();function Ma(e){if(typeof e=="string"){var t={type:e};return t.toString=function(){return e},t}return e}function $e(e){return p(p({type:Le},e),{toJSON:function(){e.onDone,e.onError;var t=Se(e,["onDone","onError"]);return p(p({},t),{type:Le,src:Ma(e.src)})}})}var Ae="",hr="#",Ke="*",Pe={},_e=function(e){return e[0]===hr},ja=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},La=function(e,t,r){var n=r.slice(0,-1).some(function(o){return!("cond"in o)&&!("in"in o)&&(S(o.target)||fe(o.target))}),i=t===Ae?"the transient event":"event '".concat(t,"'");J(!n,"One or more transitions for ".concat(i," on state '").concat(e.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Gn=function(){function e(t,r,n,i){var o=this;n===void 0&&(n="context"in t?t.context:void 0);var a;this.config=t,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(ja(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:st),this.id=this.config.id||_([this.machine.key],w(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(a=this.config.schema)!==null&&a!==void 0?a:{},this.description=this.config.description,q||J(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Oe(this.config.states,function(c,f){var d,l=new e(c,{},void 0,{parent:o,key:f});return Object.assign(o.idMap,p((d={},d[l.id]=l,d),l.idMap)),l}):Pe;var s=0;function u(c){var f,d;c.order=s++;try{for(var l=N(he(c)),h=l.next();!h.done;h=l.next()){var g=h.value;u(g)}}catch(y){f={error:y}}finally{try{h&&!h.done&&(d=l.return)&&d.call(l)}finally{if(f)throw f.error}}}u(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(c){var f=c.event;return f===Ae}):Ae in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=H(this.config.entry||this.config.onEntry).map(function(c){return Te(c)}),this.onExit=H(this.config.exit||this.config.onExit).map(function(c){return Te(c)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=H(this.config.invoke).map(function(c,f){var d,l;if(fe(c)){var h=Fe(o.id,f);return o.machine.options.services=p((d={},d[h]=c,d),o.machine.options.services),$e({src:h,id:h})}else if(S(c.src)){var h=c.id||Fe(o.id,f);return $e(p(p({},c),{id:h,src:c.src}))}else if(fe(c.src)||I(c.src)){var h=c.id||Fe(o.id,f);return o.machine.options.services=p((l={},l[h]=c.src,l),o.machine.options.services),$e(p(p({id:h},c),{src:h}))}else{var g=c.src;return $e(p(p({id:Fe(o.id,f)},c),{src:g}))}}),this.activities=H(this.config.activities).concat(this.invoke).map(function(c){return yt(c)}),this.transition=this.transition.bind(this),this.tags=H(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||fr(this).forEach(function(t){return t.on})},e.prototype.withConfig=function(t,r){var n=this.options,i=n.actions,o=n.activities,a=n.guards,s=n.services,u=n.delays;return new e(this.config,{actions:p(p({},i),t.actions),activities:p(p({},o),t.activities),guards:p(p({},a),t.guards),services:p(p({},s),t.services),delays:p(p({},u),t.delays)},r??this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return I(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Oe(this.states,function(t){return t.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var r=t===Ae,n=this.transitions.filter(function(i){var o=i.eventType===t;return r?o:o||i.eventType===Ke});return this.__cache.candidates[t]=n,n},e.prototype.getDelayedTransitions=function(){var t=this,r=this.config.after;if(!r)return[];var n=function(o,a){var s=I(o)?"".concat(t.id,":delay[").concat(a,"]"):o,u=Mn(s,t.id);return t.onEntry.push(gt(u,{delay:o})),t.onExit.push(In(u)),u},i=ce(r)?r.map(function(o,a){var s=n(o.delay,a);return p(p({},o),{event:s})}):P(Object.keys(r).map(function(o,a){var s=r[o],u=S(s)?{target:s}:s,c=isNaN(+o)?o:+o,f=n(c,a);return H(u).map(function(d){return p(p({},d),{event:f,delay:c})})}));return i.map(function(o){var a=o.delay;return p(p({},t.formatTransition(o)),{delay:a})})},e.prototype.getStateNodes=function(t){var r,n=this;if(!t)return[];var i=t instanceof Z?t.value:be(t,this.delimiter);if(S(i)){var o=this.getStateNode(i).initial;return o!==void 0?this.getStateNodes((r={},r[i]=o,r)):[this,this.states[i]]}var a=Object.keys(i),s=[this];return s.push.apply(s,_([],w(P(a.map(function(u){return n.getStateNode(u).getStateNodes(i[u])}))),!1)),s},e.prototype.handles=function(t){var r=ft(t);return this.events.includes(r)},e.prototype.resolveState=function(t){var r=t instanceof Z?t:Z.create(t),n=Array.from(pe([],this.getStateNodes(r.value)));return new Z(p(p({},r),{value:this.resolve(r.value),configuration:n,done:Je(n,this),tags:lr(n)}))},e.prototype.transitionLeafNode=function(t,r,n){var i=this.getStateNode(t),o=i.next(r,n);return!o||!o.transitions.length?this.next(r,n):o},e.prototype.transitionCompoundNode=function(t,r,n){var i=Object.keys(t),o=this.getStateNode(i[0]),a=o._transition(t[i[0]],r,n);return!a||!a.transitions.length?this.next(r,n):a},e.prototype.transitionParallelNode=function(t,r,n){var i,o,a={};try{for(var s=N(Object.keys(t)),u=s.next();!u.done;u=s.next()){var c=u.value,f=t[c];if(!!f){var d=this.getStateNode(c),l=d._transition(f,r,n);l&&(a[c]=l)}}}catch(v){i={error:v}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}var h=Object.keys(a).map(function(v){return a[v]}),g=P(h.map(function(v){return v.transitions})),y=h.some(function(v){return v.transitions.length>0});if(!y)return this.next(r,n);var m=P(h.map(function(v){return v.entrySet})),T=P(Object.keys(a).map(function(v){return a[v].configuration}));return{transitions:g,entrySet:m,exitSet:P(h.map(function(v){return v.exitSet})),configuration:T,source:r,actions:P(Object.keys(a).map(function(v){return a[v].actions}))}},e.prototype._transition=function(t,r,n){return S(t)?this.transitionLeafNode(t,r,n):Object.keys(t).length===1?this.transitionCompoundNode(t,r,n):this.transitionParallelNode(t,r,n)},e.prototype.getTransitionData=function(t,r){return this._transition(t.value,t,le(r))},e.prototype.next=function(t,r){var n,i,o=this,a=r.name,s=[],u=[],c;try{for(var f=N(this.getCandidates(a)),d=f.next();!d.done;d=f.next()){var l=d.value,h=l.cond,g=l.in,y=t.context,m=g?S(g)&&_e(g)?t.matches(be(this.getStateNodeById(g).path,this.delimiter)):Ue(be(g,this.delimiter),wn(this.path.slice(0,-2))(t.value)):!0,T=!1;try{T=!h||vt(this.machine,h,y,r,t)}catch(R){throw new Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,`':
`).concat(R.message))}if(T&&m){l.target!==void 0&&(u=l.target),s.push.apply(s,_([],w(l.actions),!1)),c=l;break}}}catch(R){n={error:R}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}if(!!c){if(!u.length)return{transitions:[c],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:s};var v=P(u.map(function(R){return o.getRelativeStateNodes(R,t.historyValue)})),E=!!c.internal,C=E?[]:P(v.map(function(R){return o.nodesFromChild(R)}));return{transitions:[c],entrySet:C,exitSet:E?[]:[this],configuration:v,source:t,actions:s}}},e.prototype.nodesFromChild=function(t){if(t.escapes(this))return[];for(var r=[],n=t;n&&n!==this;)r.push(n),n=n.parent;return r.push(this),r},e.prototype.escapes=function(t){if(this===t)return!1;for(var r=this.parent;r;){if(r===t)return!1;r=r.parent}return!0},e.prototype.getActions=function(t,r,n,i){var o,a,s,u,c=pe([],i?this.getStateNodes(i.value):[this]),f=t.configuration.length?pe(c,t.configuration):c;try{for(var d=N(f),l=d.next();!l.done;l=d.next()){var h=l.value;ze(c,h)||t.entrySet.push(h)}}catch(x){o={error:x}}finally{try{l&&!l.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}try{for(var g=N(c),y=g.next();!y.done;y=g.next()){var h=y.value;(!ze(f,h)||ze(t.exitSet,h.parent))&&t.exitSet.push(h)}}catch(x){s={error:x}}finally{try{y&&!y.done&&(u=g.return)&&u.call(g)}finally{if(s)throw s.error}}var m=P(t.entrySet.map(function(x){var A=[];if(x.type!=="final")return A;var L=x.parent;if(!L.parent)return A;A.push(We(x.id,x.doneData),We(L.id,x.doneData?dt(x.doneData,r,n):void 0));var D=L.parent;return D.type==="parallel"&&he(D).every(function(z){return Je(t.configuration,z)})&&A.push(We(D.id)),A}));t.exitSet.sort(function(x,A){return A.order-x.order}),t.entrySet.sort(function(x,A){return x.order-A.order});var T=new Set(t.entrySet),v=new Set(t.exitSet),E=w([P(Array.from(T).map(function(x){return _(_([],w(x.activities.map(function(A){return Cn(A)})),!1),w(x.onEntry),!1)})).concat(m.map(Nn)),P(Array.from(v).map(function(x){return _(_([],w(x.onExit),!1),w(x.activities.map(function(A){return Dn(A)})),!1)}))],2),C=E[0],R=E[1],G=Ve(R.concat(t.actions).concat(C),this.machine.options.actions);return G},e.prototype.transition=function(t,r,n){t===void 0&&(t=this.initialState);var i=le(r),o;if(t instanceof Z)o=n===void 0?t:this.resolveState(Z.from(t,n));else{var a=S(t)?this.resolve(qe(this.getResolvedPath(t))):this.resolve(t),s=n??this.machine.context;o=this.resolveState(Z.from(a,s))}if(!q&&i.name===Ke)throw new Error("An event cannot have the wildcard type ('".concat(Ke,"')"));if(this.strict&&!this.events.includes(i.name)&&!On(i.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(i.name,"'"));var u=this._transition(o.value,o,i)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},c=pe([],this.getStateNodes(o.value)),f=u.configuration.length?pe(c,u.configuration):c;return u.configuration=_([],w(f),!1),this.resolveTransition(u,o,o.context,i)},e.prototype.resolveRaisedTransition=function(t,r,n){var i,o=t.actions;return t=this.transition(t,r),t._event=n,t.event=n.data,(i=t.actions).unshift.apply(i,_([],w(o),!1)),t},e.prototype.resolveTransition=function(t,r,n,i){var o,a,s=this;i===void 0&&(i=He);var u=t.configuration,c=!r||t.transitions.length>0,f=c?Vn(this.machine,u):void 0,d=r?r.historyValue?r.historyValue:t.source?this.machine.historyValue(r.value):void 0:void 0,l=this.getActions(t,n,i,r),h=r?p({},r.activities):{};try{for(var g=N(l),y=g.next();!y.done;y=g.next()){var m=y.value;m.type===tr?h[m.activity.id||m.activity.type]=m:m.type===ot&&(h[m.activity.id||m.activity.type]=!1)}}catch(B){o={error:B}}finally{try{y&&!y.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}var T=w(mt(this,r,n,i,l,this.machine.config.preserveActionOrder),2),v=T[0],E=T[1],C=w(ht(v,function(B){return B.type===xe||B.type===je&&B.to===we.Internal}),2),R=C[0],G=C[1],x=v.filter(function(B){var me;return B.type===tr&&((me=B.activity)===null||me===void 0?void 0:me.type)===Le}),A=x.reduce(function(B,me){return B[me.activity.id]=Bn(me.activity,s.machine,E,i),B},r?p({},r.children):{}),L=c?t.configuration:r?r.configuration:[],D=Je(L,this),z=new Z({value:f||r.value,context:E,_event:i,_sessionid:r?r._sessionid:null,historyValue:f?d?Pn(d,f):void 0:r?r.historyValue:void 0,history:!f||t.source?r:void 0,actions:f?G:[],activities:f?h:r?r.activities:{},events:[],configuration:L,transitions:t.transitions,children:A,done:D,tags:r==null?void 0:r.tags,machine:this}),oe=n!==E;z.changed=i.name===rr||oe;var ve=z.history;ve&&delete ve.history;var kr=!D&&(this._transient||u.some(function(B){return B._transient}));if(!c&&(!kr||i.name===Ae))return z;var U=z;if(!D)for(kr&&(U=this.resolveRaisedTransition(U,{type:vn},i));R.length;){var lo=R.shift();U=this.resolveRaisedTransition(U,lo._event,i)}var ho=U.changed||(ve?!!U.actions.length||oe||typeof ve.value!=typeof U.value||!dr(U.value,ve.value):void 0);return U.changed=ho,U.history=ve,U.tags=lr(U.configuration),U},e.prototype.getStateNode=function(t){if(_e(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[t];if(!r)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return r},e.prototype.getStateNodeById=function(t){var r=_e(t)?t.slice(hr.length):t;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(t){if(typeof t=="string"&&_e(t))try{return this.getStateNodeById(t.slice(1))}catch{}for(var r=lt(t,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},e.prototype.resolve=function(t){var r,n=this;if(!t)return this.initialStateValue||Pe;switch(this.type){case"parallel":return Oe(this.initialStateValue,function(o,a){return o?n.getStateNode(a).resolve(t[a]||o):Pe});case"compound":if(S(t)){var i=this.getStateNode(t);return i.type==="parallel"||i.type==="compound"?(r={},r[t]=i.initialStateValue,r):t}return Object.keys(t).length?Oe(t,function(o,a){return o?n.getStateNode(a).resolve(o):Pe}):this.initialStateValue||{};default:return t||Pe}},e.prototype.getResolvedPath=function(t){if(_e(t)){var r=this.machine.idMap[t.slice(hr.length)];if(!r)throw new Error("Unable to find state node '".concat(t,"'"));return r.path}return lt(t,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=ir(this.states,function(n){return n.initialStateValue||Pe},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=Ge(this.states[this.initial])?this.initial:(t={},t[this.initial]=this.states[this.initial].initialStateValue,t)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(t,r){this._init();var n=this.getStateNodes(t);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r??this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var t;if(this.type==="history"){var r=this.config;S(r.target)?t=_e(r.target)?qe(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:t=r.target}return t},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(t,r,n){return n===void 0&&(n=!0),n?t.type==="history"?t.resolveHistory(r):t.initialStateNodes:[t]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var t=this;if(Ge(this))return[this];if(this.type==="compound"&&!this.initial)return q||J(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=Be(this.initialStateValue);return P(r.map(function(n){return t.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var r=w(t),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var o=this.getStateNode(n);if(o.type==="history")return o.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},e.prototype.historyValue=function(t){if(!!Object.keys(this.states).length)return{current:t||this.initialStateValue,states:ir(this.states,function(r,n){if(!t)return r.historyValue();var i=S(t)?void 0:t[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},e.prototype.resolveHistory=function(t){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!t){var i=this.target;return i?P(Be(i).map(function(a){return n.getFromRelativePath(a)})):n.initialStateNodes}var o=xn(n.path,"states")(t).current;return S(o)?[n.getStateNode(o)]:P(Be(o).map(function(a){return r.history==="deep"?n.getFromRelativePath(a):[n.states[a[0]]]}))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var t=this,r=P(Object.keys(this.states).map(function(n){return t.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var t,r,n,i;if(this.__cache.events)return this.__cache.events;var o=this.states,a=new Set(this.ownEvents);if(o)try{for(var s=N(Object.keys(o)),u=s.next();!u.done;u=s.next()){var c=u.value,f=o[c];if(f.states)try{for(var d=(n=void 0,N(f.events)),l=d.next();!l.done;l=d.next()){var h=l.value;a.add("".concat(h))}}catch(g){n={error:g}}finally{try{l&&!l.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}}catch(g){t={error:g}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(a)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(t)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(t){var r=this;if(t!==void 0)return t.map(function(n){if(!S(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var o=i?r.key+n:n;if(r.parent)try{var a=r.parent.getStateNodeByPath(o);return a}catch(s){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(s.message))}else return r.getStateNodeByPath(o)})},e.prototype.formatTransition=function(t){var r=this,n=_n(t.target),i="internal"in t?t.internal:n?n.some(function(u){return S(u)&&u[0]===r.delimiter}):!0,o=this.machine.options.guards,a=this.resolveTarget(n),s=p(p({},t),{actions:Ve(H(t.actions)),cond:pt(t.cond,o),target:a,source:this,internal:i,eventType:t.event,toJSON:function(){return p(p({},s),{target:s.target?s.target.map(function(u){return"#".concat(u.id)}):void 0,source:"#".concat(r.id)})}});return s},e.prototype.formatTransitions=function(){var t,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var o=this.config.on,a=Ke,s=o[a],u=s===void 0?[]:s,c=Se(o,[typeof a=="symbol"?a:a+""]);i=P(Object.keys(c).map(function(v){!q&&v===Ae&&J(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var E=de(v,c[v]);return q||La(n,v,E),E}).concat(de(Ke,u)))}var f=this.config.always?de("",this.config.always):[],d=this.config.onDone?de(String(We(this.id)),this.config.onDone):[];q||J(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var l=P(this.invoke.map(function(v){var E=[];return v.onDone&&E.push.apply(E,_([],w(de(String(ur(v.id)),v.onDone)),!1)),v.onError&&E.push.apply(E,_([],w(de(String(jn(v.id)),v.onError)),!1)),E})),h=this.after,g=P(_(_(_(_([],w(d),!1),w(l),!1),w(i),!1),w(f),!1).map(function(v){return H(v).map(function(E){return n.formatTransition(E)})}));try{for(var y=N(h),m=y.next();!m.done;m=y.next()){var T=m.value;g.push(T)}}catch(v){t={error:v}}finally{try{m&&!m.done&&(r=y.return)&&r.call(y)}finally{if(t)throw t.error}}return g},e}();function ee(e,t){return new Gn(e,t)}var k=kn;var Et="nhostRefreshToken",Ye="nhostRefreshTokenExpiresAt",zn=3,Jn=900,$n=60,Oc=10,Tc=30;var St={status:10,error:"invalid-email",message:"Email is incorrectly formatted"},wt={status:10,error:"invalid-password",message:"Password is incorrectly formatted"};var ro=wo(to());var ie=e=>{let t=ro.default.create({baseURL:e});return t.interceptors.response.use(r=>r,r=>Promise.reject({error:{message:r.response?.data?.message??r.message??r.request.responseText??JSON.stringify(r),status:r.response?.status??r.response?.data.statusCode??0,error:r.response?.data.error||r.request.statusText||"network"}})),t};var Rt=e=>!!e&&typeof e=="string"&&String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),Nt=e=>!!e&&typeof e=="string"&&e.length>=3;var no={user:null,mfa:!1,accessToken:{value:null,expiresAt:new Date},refreshTimer:{elapsed:0,attempts:0},refreshToken:{value:null},errors:{}};var vf=({backendUrl:e,clientUrl:t,interpreter:r})=>{let n=ie(e);return ee({schema:{context:{},events:{}},tsTypes:{},id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST_CHANGE:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:"idle.success",onError:{actions:"saveRequestError",target:"idle.error"}}}}},{actions:{saveInvalidEmailError:k({error:i=>St}),saveRequestError:k({error:(i,{data:{error:o}})=>o})},guards:{invalidEmail:(i,{email:o})=>!Rt(o)},services:{requestChange:async(i,{email:o,options:a})=>(await n.post("/v1/auth/user/email/change",{newEmail:o,options:{redirectTo:a?.redirectTo?.startsWith("/")?t+a.redirectTo:a?.redirectTo}},{headers:{authorization:`Bearer ${r?.state.context.accessToken.value}`}})).data}})};var xf=({backendUrl:e,interpreter:t})=>{let r=ie(e);return ee({schema:{context:{},events:{}},tsTypes:{},id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST_CHANGE:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:"idle.success",onError:{actions:"saveRequestError",target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:k({error:n=>wt}),saveRequestError:k({error:(n,{data:{error:i}})=>(console.log(i),i)})},guards:{invalidPassword:(n,{password:i})=>!Nt(i)},services:{requestChange:(n,{password:i})=>r.post("/v1/auth/user/password",{newPassword:i},{headers:{authorization:`Bearer ${t?.state.context.accessToken.value}`}})}})};var Pf=({backendUrl:e,clientUrl:t})=>{let r=ie(e);return ee({schema:{context:{},events:{}},tsTypes:{},id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST_CHANGE:"requesting"},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:"idle.success",onError:{actions:"saveRequestError",target:"idle.error"}}}}},{actions:{saveRequestError:k({error:(n,{data:{error:i}})=>(console.log(i),i)})},services:{requestChange:(n,{email:i,options:o})=>r.post("/v1/auth/user/password/reset",{email:i,options:{redirectTo:o?.redirectTo?.startsWith("/")?t+o.redirectTo:o?.redirectTo}})}})};var io=({backendUrl:e,clientUrl:t,storageSetter:r,storageGetter:n,autoRefreshToken:i=!0,autoSignIn:o=!0})=>{let a=ie(e),s=async(u,c,f)=>(await a.post(u,c,f)).data;return ee({schema:{context:{},events:{}},tsTypes:{},context:hn(no,u=>{let c=n(Ye);c&&(u.accessToken.expiresAt=new Date(c)),u.refreshToken.value=n(Et)}),id:"nhost",type:"parallel",states:{authentication:{initial:"checkAutoSignIn",on:{TRY_TOKEN:"#nhost.token.running",SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","persist","resetTimer"],target:".signedIn"}]},states:{checkAutoSignIn:{always:[{cond:"isAutoSignInDisabled",target:"starting"}],invoke:[{id:"autoSignIn",src:"autoSignIn",onDone:{target:"signedIn",actions:["saveSession","persist"]},onError:"starting"}]},starting:{always:[{cond:"isSignedIn",target:"signedIn"},{cond:"hasRefreshTokenWithoutSession",target:["authenticating.token","#nhost.token.running"]},"signedOut"]},signedOut:{tags:["ready"],initial:"noErrors",states:{noErrors:{},success:{},needsVerification:{},failed:{exit:"resetAuthenticationError",initial:"server",states:{server:{entry:"saveAuthenticationError"},validation:{states:{password:{entry:"saveInvalidPassword"},email:{entry:"saveInvalidEmail"}}}}},signingOut:{entry:"destroyToken",invoke:{src:"signout",id:"signingOut",onDone:"success",onError:"failed.server"}}},on:{SIGNIN_PASSWORD:[{cond:"invalidEmail",target:".failed.validation.email"},{cond:"invalidPassword",target:".failed.validation.password"},"#nhost.authentication.authenticating.password"],SIGNIN_PASSWORDLESS_EMAIL:[{cond:"invalidEmail",target:".failed.validation.email"},"#nhost.authentication.authenticating.passwordlessEmail"],SIGNUP_EMAIL_PASSWORD:[{cond:"invalidEmail",target:".failed.validation.email"},{cond:"invalidPassword",target:".failed.validation.password"},"#nhost.authentication.registering"],SIGNIN_ANONYMOUS:"#nhost.authentication.authenticating.anonymous"}},authenticating:{states:{passwordlessEmail:{invoke:{src:"signInPasswordlessEmail",id:"authenticatePasswordlessEmail",onDone:"#nhost.authentication.signedOut.needsVerification",onError:"#nhost.authentication.signedOut.failed.server"}},password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:{actions:["saveSession","persist"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:"#nhost.authentication.signedOut.needsVerification"},{target:"#nhost.authentication.signedOut.failed.server"}]}},token:{},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","persist"],target:"#nhost.authentication.signedIn"},onError:"#nhost.authentication.signedOut.failed.server"}}}},registering:{invoke:{src:"registerUser",id:"registerUser",onDone:[{cond:"hasSession",target:"#nhost.authentication.signedIn",actions:["saveSession","persist"]},{target:"#nhost.authentication.signedOut.needsVerification"}],onError:[{cond:"unverified",target:"#nhost.authentication.signedOut.needsVerification"},{actions:"saveRegisrationError",target:"#nhost.authentication.signedOut.failed.server"}]}},signedIn:{tags:["ready"],type:"parallel",on:{SIGNOUT:"#nhost.authentication.signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{"1000":{actions:"tickRefreshTimer",internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","persist","resetTimer"],target:"pending"},onError:[]}}}}}}}}}},token:{initial:"idle",states:{idle:{},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","persist"],target:["#nhost.authentication.signedIn","idle"]},onError:{target:["#nhost.authentication.signedOut","idle"]}}}}}}},{actions:{saveSession:k({user:(u,c)=>c.data?.session?.user,accessToken:(u,c)=>({value:c.data?.session?.accessToken,expiresAt:new Date(Date.now()+c.data?.session?.accessTokenExpiresIn*1e3)}),refreshToken:(u,c)=>({value:c.data?.session?.refreshToken}),mfa:(u,c)=>c.data?.mfa??!1}),resetTimer:k({refreshTimer:(u,c)=>({elapsed:0,attempts:0})}),tickRefreshTimer:k({refreshTimer:(u,c)=>({elapsed:u.refreshTimer.elapsed+1,attempts:u.refreshTimer.attempts})}),saveAuthenticationError:k({errors:({errors:u},{data:{error:c}})=>({...u,authentication:c})}),resetAuthenticationError:k({errors:({errors:{authentication:u,...c}})=>c}),saveInvalidEmail:k({errors:({errors:u})=>({...u,authentication:St})}),saveInvalidPassword:k({errors:({errors:u})=>({...u,authentication:wt})}),saveRegisrationError:k({errors:({errors:u},{data:{error:c}})=>({...u,registration:c})}),persist:(u,{data:c})=>{if(r(Et,c.session.refreshToken),c.session.accessTokenExpiresIn){let f=new Date(Date.now()+c.session.accessTokenExpiresIn*1e3).toISOString();r(Ye,f)}else r(Ye,null)},destroyToken:()=>{r(Et,null),r(Ye,null)}},guards:{isSignedIn:u=>!!u.user&&!!u.refreshToken.value&&!!u.accessToken.value,hasRefreshTokenWithoutSession:u=>!!u.refreshToken.value&&!u.user&&!u.accessToken.value,noToken:u=>!u.refreshToken.value,hasRefreshToken:u=>!!u.refreshToken.value,isAutoRefreshDisabled:()=>!i,isAutoSignInDisabled:()=>!o,refreshTimerShouldRefresh:u=>u.refreshTimer.elapsed>Math.max((Date.now()-u.accessToken.expiresAt.getTime())/1e3-900,60),unverified:(u,{data:{error:c}})=>c.status===401&&c.message==="Email is not verified",hasSession:(u,c)=>!!c.data?.session,invalidEmail:(u,{email:c})=>!Rt(c),invalidPassword:(u,{password:c})=>!Nt(c)},services:{signInPassword:(u,{email:c,password:f})=>s("/v1/auth/signin/email-password",{email:c,password:f}),signInPasswordlessEmail:(u,{email:c,options:f})=>s("/v1/auth/signin/passwordless/email",{email:c,options:{...f,redirectTo:f?.redirectTo?.startsWith("/")?t+f.redirectTo:f?.redirectTo}}),signInAnonymous:u=>s("/v1/auth/signin/anonymous"),refreshToken:async(u,c)=>{let f=c.type==="TRY_TOKEN"?c.token:u.refreshToken.value;return{session:await s("/v1/auth/token",{refreshToken:f})}},signout:(u,c)=>s("/v1/auth/signout",{refreshToken:u.refreshToken.value,all:!!c.all}),registerUser:(u,{email:c,password:f,options:d})=>s("/v1/auth/signup/email-password",{email:c,password:f,options:{...d,redirectTo:d?.redirectTo?.startsWith("/")?t+d.redirectTo:d?.redirectTo}}),autoSignIn:async()=>{if(typeof window<"u"){let u=window.location;if(u.hash){let f=new URLSearchParams(u.hash.slice(1)).get("refreshToken");if(f){let d=await s("/v1/auth/token",{refreshToken:f});return window.history.pushState({},"",u.pathname),new ae("nhost").postMessage(f),{session:d}}}throw Error()}}}})};function It(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Cs={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Dr(e,t){function r(i,o,a){if(!(typeof document>"u")){a=It({},t,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var u in a)!a[u]||(s+="; "+u,a[u]!==!0&&(s+="="+a[u].split(";")[0]));return document.cookie=i+"="+e.write(o,i)+s}}function n(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var o=document.cookie?document.cookie.split("; "):[],a={},s=0;s<o.length;s++){var u=o[s].split("="),c=u.slice(1).join("=");try{var f=decodeURIComponent(u[0]);if(a[f]=e.read(c,f),i===f)break}catch{}}return i?a[i]:a}}return Object.create({set:r,get:n,remove:function(i,o){r(i,"",It({},o,{expires:-1}))},withAttributes:function(i){return Dr(this.converter,It({},this.attributes,i))},withConverter:function(i){return Dr(It({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var Ds=Dr(Cs,{path:"/"}),Ct=Ds;var Dt=typeof window<"u",oo=e=>Dt&&localStorage?localStorage.getItem(e):(console.warn("no defaultStorageGetter"),null),ao=(e,t)=>{Dt&&localStorage?t?localStorage.setItem(e,t):localStorage.removeItem(e):console.warn("no defaultStorageSetter")},so=e=>Dt?Ct.get(e)??null:null,uo=(e,t)=>{Dt&&(t?Ct.set(e,t):Ct.remove(e))};var kt=class{backendUrl;clientUrl;machine;interpreter;#e;constructor({backendUrl:t,clientUrl:r=typeof window<"u"?window.location.origin:"",storageGetter:n=oo,storageSetter:i=ao,autoSignIn:o=!0,autoRefreshToken:a=!0}){this.backendUrl=t,this.clientUrl=r;let s=io({backendUrl:t,clientUrl:r,storageGetter:n,storageSetter:i,autoSignIn:o,autoRefreshToken:a});this.machine=s,typeof window<"u"&&o&&(this.#e=new ae("nhost"),this.#e.addEventListener("message",u=>{let c=this.interpreter?.state.context.refreshToken;this.interpreter&&u!==c&&this.interpreter.send({type:"TRY_TOKEN",token:u})}))}};var co=typeof window!==void 0,fo=class extends kt{constructor({backendUrl:t}){super({backendUrl:t,autoSignIn:co,autoRefreshToken:co,storageGetter:so,storageSetter:uo})}};export{zn as MIN_PASSWORD_LENGTH,$n as MIN_TOKEN_REFRESH_INTERVAL,Ye as NHOST_JWT_EXPIRES_AT_KEY,Et as NHOST_REFRESH_TOKEN_KEY,kt as Nhost,fo as NhostSSR,Oc as REFRESH_TOKEN_RETRY_INTERVAL,Tc as REFRESH_TOKEN_RETRY_MAX_ATTEMPTS,Jn as TOKEN_REFRESH_MARGIN,so as cookieStorageGetter,uo as cookieStorageSetter,vf as createChangeEmailMachine,xf as createChangePasswordMachine,io as createNhostMachine,Pf as createResetPasswordMachine,oo as defaultStorageGetter,ao as defaultStorageSetter};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! js-cookie v3.0.1 | MIT */
//# sourceMappingURL=index.es.js.map
